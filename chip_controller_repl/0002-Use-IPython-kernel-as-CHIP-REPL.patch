From 0045aa385614f33480e12b399fc70b911b085ce2 Mon Sep 17 00:00:00 2001
Message-Id: <0045aa385614f33480e12b399fc70b911b085ce2.1651675627.git.stefan@agner.ch>
In-Reply-To: <0f7bb79464a8078930862622dcd85ec55c60278f.1651675627.git.stefan@agner.ch>
References: <0f7bb79464a8078930862622dcd85ec55c60278f.1651675627.git.stefan@agner.ch>
From: Stefan Agner <stefan@agner.ch>
Date: Wed, 4 May 2022 16:09:26 +0200
Subject: [PATCH] Use IPython kernel as CHIP REPL

---
 src/controller/python/chip-repl.py | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/controller/python/chip-repl.py b/src/controller/python/chip-repl.py
index 1b76382163..823156569a 100755
--- a/src/controller/python/chip-repl.py
+++ b/src/controller/python/chip-repl.py
@@ -18,6 +18,7 @@
 #
 
 import IPython
+import ipykernel
 import chip
 import chip.logging
 import coloredlogs
@@ -39,6 +40,8 @@ def main():
     args = parser.parse_args()
 
     c = Config()
+    c.ConnectionFileMixin.connection_file = "kernel.json"
+    c.InteractiveShellApp.gui = "asyncio"
     c.InteractiveShellApp.exec_lines = [
         "import pkgutil",
         "module = pkgutil.get_loader('chip.ChipReplStartup')",
@@ -47,7 +50,7 @@ def main():
 
     sys.argv = [sys.argv[0]]
 
-    IPython.start_ipython(config=c)
+    IPython.start_kernel(config=c)
 
 
 if __name__ == "__main__":
-- 
2.36.0

