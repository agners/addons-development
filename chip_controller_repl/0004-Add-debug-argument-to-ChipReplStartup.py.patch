From 1f3fadee9cdc93c8367c6a0f47a00136edb94197 Mon Sep 17 00:00:00 2001
Message-Id: <1f3fadee9cdc93c8367c6a0f47a00136edb94197.1652462795.git.stefan@agner.ch>
In-Reply-To: <73d547fc5d3c1793df8955dc8db95351b59a8d26.1652462795.git.stefan@agner.ch>
References: <73d547fc5d3c1793df8955dc8db95351b59a8d26.1652462795.git.stefan@agner.ch>
From: Stefan Agner <stefan@agner.ch>
Date: Fri, 13 May 2022 18:37:03 +0200
Subject: [PATCH] Add debug argument to ChipReplStartup.py

---
 src/controller/python/chip/ChipReplStartup.py | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)

diff --git a/src/controller/python/chip/ChipReplStartup.py b/src/controller/python/chip/ChipReplStartup.py
index b4008558cc..efdf8ea4cb 100644
--- a/src/controller/python/chip/ChipReplStartup.py
+++ b/src/controller/python/chip/ChipReplStartup.py
@@ -67,7 +67,7 @@ def CreateDefaultDeviceController():
     return _fabricAdmins[0].NewController()
 
 
-def ReplInit():
+def ReplInit(debug):
     #
     # Install the pretty printer that rich provides to replace the existing
     # printer.
@@ -93,8 +93,10 @@ def ReplInit():
     coloredlogs.install(level='DEBUG')
     chip.logging.RedirectToPythonLogging()
 
-    # logging.getLogger().setLevel(logging.DEBUG)
-    logging.getLogger().setLevel(logging.WARN)
+    if debug:
+        logging.getLogger().setLevel(logging.DEBUG)
+    else:
+        logging.getLogger().setLevel(logging.WARN)
 
 
 def StackShutdown():
@@ -129,8 +131,11 @@ console = Console()
 parser = argparse.ArgumentParser()
 parser.add_argument(
     "-p", "--storagepath", help="Path to persistent storage configuration file (default: /tmp/repl-storage.json)", action="store", default="/tmp/repl-storage.json")
+parser.add_argument(
+    "-d", "--debug", help="Set default logging level to debug.", action="store_true")
 args = parser.parse_args()
-ReplInit()
+
+ReplInit(args.debug)
 chipStack = ChipStack(persistentStoragePath=args.storagepath)
 fabricAdmins = LoadFabricAdmins()
 devCtrl = CreateDefaultDeviceController()
-- 
2.36.1

